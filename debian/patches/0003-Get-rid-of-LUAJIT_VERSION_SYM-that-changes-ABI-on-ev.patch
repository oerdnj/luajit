From: =?utf-8?q?Ond=C5=99ej_Sur=C3=BD?= <ondrej@sury.org>
Date: Thu, 19 Nov 2015 16:29:02 +0200
Subject: Get rid of LUAJIT_VERSION_SYM that changes ABI on every patch release

---
 src/lj_dispatch.c | 5 -----
 src/luajit.c      | 1 -
 src/luajit.h      | 4 ----
 3 files changed, 10 deletions(-)

diff --git a/src/lj_dispatch.c b/src/lj_dispatch.c
index 1a07371..32cc63e 100644
--- a/src/lj_dispatch.c
+++ b/src/lj_dispatch.c
@@ -319,11 +319,6 @@ int luaJIT_setmode(lua_State *L, int idx, int mode)
   return 1;  /* OK. */
 }
 
-/* Enforce (dynamic) linker error for version mismatches. See luajit.c. */
-LUA_API void LUAJIT_VERSION_SYM(void)
-{
-}
-
 /* -- Hooks --------------------------------------------------------------- */
 
 /* This function can be called asynchronously (e.g. during a signal). */
diff --git a/src/luajit.c b/src/luajit.c
index 0ebc730..0885e62 100644
--- a/src/luajit.c
+++ b/src/luajit.c
@@ -512,7 +512,6 @@ static int pmain(lua_State *L)
   int flags = 0;
   globalL = L;
   if (argv[0] && argv[0][0]) progname = argv[0];
-  LUAJIT_VERSION_SYM();  /* linker-enforced version check */
   script = collectargs(argv, &flags);
   if (script < 0) {  /* invalid args? */
     print_usage();
diff --git a/src/luajit.h b/src/luajit.h
index 9604185..594ef2f 100644
--- a/src/luajit.h
+++ b/src/luajit.h
@@ -32,7 +32,6 @@
 
 #define LUAJIT_VERSION		"LuaJIT 2.1.0-beta1"
 #define LUAJIT_VERSION_NUM	20100  /* Version 2.1.0 = 02.01.00. */
-#define LUAJIT_VERSION_SYM	luaJIT_version_2_1_0_beta1
 #define LUAJIT_COPYRIGHT	"Copyright (C) 2005-2015 Mike Pall"
 #define LUAJIT_URL		"http://luajit.org/"
 
@@ -73,7 +72,4 @@ LUA_API void luaJIT_profile_stop(lua_State *L);
 LUA_API const char *luaJIT_profile_dumpstack(lua_State *L, const char *fmt,
 					     int depth, size_t *len);
 
-/* Enforce (dynamic) linker error for version mismatches. Call from main. */
-LUA_API void LUAJIT_VERSION_SYM(void);
-
 #endif
